<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Settings Page Translations</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 12px; }
        button { padding: 10px 20px; margin: 5px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .translation-key { font-family: monospace; background-color: #f8f9fa; padding: 2px 4px; border-radius: 3px; }
        .language-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>üåê Settings Page Translation Test</h1>
    
    <div class="test-result info">
        <strong>Testing translation keys used in the Settings page</strong><br>
        This will verify that all translation keys have corresponding values in both English and Arabic.
    </div>
    
    <button onclick="testTranslations()">Test All Translation Keys</button>
    <button onclick="testSpecificKeys()">Test Specific Missing Keys</button>
    
    <div id="results"></div>

    <script>
        // Translation keys used in SettingsView.vue
        const settingsTranslationKeys = [
            'settings.title',
            'settings.description',
            'settings.addYear',
            'settings.activeYear',
            'settings.currentlyActive',
            'settings.startDate',
            'settings.endDate',
            'settings.semesters',
            'settings.semester',
            'settings.semestersList',
            'settings.addSemester',
            'settings.editSemester',
            'settings.deleteSemester',
            'settings.noSemesters',
            'settings.noSemestersDescription',
            'settings.createFirstSemester',
            'settings.editYear',
            'settings.noActiveYear',
            'settings.noActiveYearDescription',
            'settings.createFirstYear',
            'settings.allYears',
            'settings.searchYears',
            'settings.allStatuses',
            'settings.active',
            'settings.archived',
            'settings.inactive',
            'settings.activateYear',
            'settings.archiveYear',
            'settings.restoreYear',
            'settings.noYears',
            'settings.noYearsDescription',
            'common.loading',
            'classSettings.title',
            'classSettings.description',
            'classSettings.actions.apply',
            'classSettings.durations.title',
            'classSettings.durations.addDuration',
            'classSettings.durations.description',
            'classSettings.durations.isDefault',
            'classSettings.startTimes.title',
            'classSettings.startTimes.description',
            'classSettings.startTimes.schoolStartTime',
            'classSettings.startTimes.firstClassTime',
            'classSettings.startTimes.endTime',
            'classSettings.timeSlots.title',
            'classSettings.timeSlots.regenerate',
            'classSettings.timeSlots.description',
            'common.edit',
            'common.minutes'
        ];

        // Mock translation data (simplified versions of the actual files)
        const translations = {
            en: {},
            ar: {}
        };

        async function loadTranslations() {
            try {
                // In a real app, these would be loaded from the actual translation files
                // For this test, we'll simulate the key structure
                
                // Simulate loading English translations
                const enResponse = await fetch('/src/i18n/locales/en.json');
                if (enResponse.ok) {
                    translations.en = await enResponse.json();
                } else {
                    // Fallback - simulate the structure
                    translations.en = {
                        settings: { title: "Settings", description: "Manage academic years and system settings" },
                        classSettings: { title: "Class Settings", description: "Manage class durations" },
                        common: { loading: "Loading...", edit: "Edit", minutes: "minutes" }
                    };
                }

                // Simulate loading Arabic translations
                const arResponse = await fetch('/src/i18n/locales/ar.json');
                if (arResponse.ok) {
                    translations.ar = await arResponse.json();
                } else {
                    // Fallback - simulate the structure
                    translations.ar = {
                        settings: { title: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™", description: "ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≥ŸÜŸàÿßÿ™ ÿßŸÑÿ£ŸÉÿßÿØŸäŸÖŸäÿ© Ÿàÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ" },
                        classSettings: { title: "ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ÿµÿµ", description: "ÿ•ÿØÿßÿ±ÿ© ŸÖÿØÿ© ÿßŸÑÿ≠ÿµÿµ" },
                        common: { loading: "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...", edit: "ÿ™ÿπÿØŸäŸÑ", minutes: "ÿØŸÇÿßÿ¶ŸÇ" }
                    };
                }

                return true;
            } catch (error) {
                console.error('Failed to load translations:', error);
                return false;
            }
        }

        function getNestedValue(obj, path) {
            return path.split('.').reduce((current, key) => {
                return current && current[key] !== undefined ? current[key] : undefined;
            }, obj);
        }

        async function testTranslations() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-result info">Loading translations and testing keys...</div>';

            const loaded = await loadTranslations();
            if (!loaded) {
                resultsDiv.innerHTML = '<div class="test-result error">‚ùå Failed to load translation files</div>';
                return;
            }

            let html = '<div class="test-result success"><strong>üåê Translation Test Results</strong></div>';

            // Test English translations
            html += '<div class="language-section">';
            html += '<h3>üá∫üá∏ English Translations</h3>';
            let enMissing = [];
            let enFound = [];

            for (const key of settingsTranslationKeys) {
                const value = getNestedValue(translations.en, key);
                if (value !== undefined) {
                    enFound.push({ key, value });
                } else {
                    enMissing.push(key);
                }
            }

            html += `<div class="test-result ${enMissing.length === 0 ? 'success' : 'warning'}">`;
            html += `<strong>Found:</strong> ${enFound.length}/${settingsTranslationKeys.length} keys<br>`;
            html += `<strong>Missing:</strong> ${enMissing.length} keys`;
            html += '</div>';

            if (enMissing.length > 0) {
                html += '<div class="test-result error">';
                html += '<strong>‚ùå Missing English Keys:</strong><br>';
                enMissing.forEach(key => {
                    html += `‚Ä¢ <span class="translation-key">${key}</span><br>`;
                });
                html += '</div>';
            }

            html += '</div>';

            // Test Arabic translations
            html += '<div class="language-section">';
            html += '<h3>üá∏üá¶ Arabic Translations</h3>';
            let arMissing = [];
            let arFound = [];

            for (const key of settingsTranslationKeys) {
                const value = getNestedValue(translations.ar, key);
                if (value !== undefined) {
                    arFound.push({ key, value });
                } else {
                    arMissing.push(key);
                }
            }

            html += `<div class="test-result ${arMissing.length === 0 ? 'success' : 'warning'}">`;
            html += `<strong>Found:</strong> ${arFound.length}/${settingsTranslationKeys.length} keys<br>`;
            html += `<strong>Missing:</strong> ${arMissing.length} keys`;
            html += '</div>';

            if (arMissing.length > 0) {
                html += '<div class="test-result error">';
                html += '<strong>‚ùå Missing Arabic Keys:</strong><br>';
                arMissing.forEach(key => {
                    html += `‚Ä¢ <span class="translation-key">${key}</span><br>`;
                });
                html += '</div>';
            }

            html += '</div>';

            // Summary
            const totalMissing = enMissing.length + arMissing.length;
            html += `<div class="test-result ${totalMissing === 0 ? 'success' : 'warning'}">`;
            html += '<strong>üìä Summary:</strong><br>';
            html += `‚Ä¢ Total keys tested: ${settingsTranslationKeys.length}<br>`;
            html += `‚Ä¢ English missing: ${enMissing.length}<br>`;
            html += `‚Ä¢ Arabic missing: ${arMissing.length}<br>`;
            html += `‚Ä¢ Overall status: ${totalMissing === 0 ? '‚úÖ All translations complete!' : '‚ö†Ô∏è Some translations missing'}`;
            html += '</div>';

            resultsDiv.innerHTML = html;
        }

        async function testSpecificKeys() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-result info">Testing specific keys that were recently added...</div>';

            // Keys that were likely missing and recently added
            const specificKeys = [
                'classSettings.title',
                'classSettings.description',
                'classSettings.actions.apply',
                'classSettings.durations.title',
                'classSettings.durations.addDuration',
                'classSettings.startTimes.title',
                'classSettings.timeSlots.title',
                'classSettings.timeSlots.regenerate'
            ];

            const loaded = await loadTranslations();
            if (!loaded) {
                resultsDiv.innerHTML = '<div class="test-result error">‚ùå Failed to load translation files</div>';
                return;
            }

            let html = '<div class="test-result success"><strong>üîç Specific Key Test Results</strong></div>';

            for (const key of specificKeys) {
                const enValue = getNestedValue(translations.en, key);
                const arValue = getNestedValue(translations.ar, key);

                html += '<div class="test-result info">';
                html += `<strong>Key:</strong> <span class="translation-key">${key}</span><br>`;
                html += `<strong>English:</strong> ${enValue || '‚ùå Missing'}<br>`;
                html += `<strong>Arabic:</strong> ${arValue || '‚ùå Missing'}<br>`;
                html += `<strong>Status:</strong> ${enValue && arValue ? '‚úÖ Complete' : '‚ö†Ô∏è Incomplete'}`;
                html += '</div>';
            }

            resultsDiv.innerHTML = html;
        }

        // Auto-run the test on page load
        window.onload = function() {
            testTranslations();
        };
    </script>
</body>
</html>
