<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Integration Complete - Session Media</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; }
        .fix-card { background: white; border-radius: 8px; padding: 20px; margin: 16px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .fix-header { background: #dcfce7; padding: 12px; border-radius: 6px; margin-bottom: 16px; }
        .issue-box { background: #fee2e2; border: 1px solid #fca5a5; border-radius: 6px; padding: 12px; margin: 12px 0; }
        .solution-box { background: #dcfce7; border: 1px solid #86efac; border-radius: 6px; padding: 12px; margin: 12px 0; }
        .code-block { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px; margin: 12px 0; font-family: monospace; font-size: 14px; }
        .step { margin: 12px 0; padding: 12px; border-radius: 6px; background: #f8fafc; border-left: 4px solid #3b82f6; }
        .endpoint-test { background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 6px; padding: 12px; margin: 8px 0; }
        .highlight { background: #fbbf24; padding: 2px 4px; border-radius: 3px; }
        .checklist { list-style: none; padding: 0; }
        .checklist li { padding: 8px; margin: 4px 0; border-radius: 4px; background: #f8fafc; }
        .checklist li::before { content: "âœ… "; color: #16a34a; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ… ØªÙƒØ§Ù…Ù„ Backend Ù…ÙƒØªÙ…Ù„ - Session Media</h1>
        
        <div class="fix-card">
            <div class="fix-header">
                <h2>ğŸš¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</h2>
                <p>Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¸Ù‡Ø± "Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ù„Ø§Ø­Ù‚Ø§Ù‹" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª ÙØ¹Ù„ÙŠØ§Ù‹</p>
            </div>
            
            <div class="issue-box">
                <h3>âŒ Ø§Ù„Ø³Ø¨Ø¨:</h3>
                <ul>
                    <li>Ù…ÙƒÙˆÙ†Ø§Øª SessionMedia ØºÙŠØ± Ù…Ø³Ø¬Ù„Ø© ÙÙŠ AppModule</li>
                    <li>Ù…Ø¬Ù„Ø¯ uploads/session-media ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</li>
                    <li>Static file serving ØºÙŠØ± Ù…Ø·Ø¨Ù‚</li>
                    <li>Frontend ÙŠØ³ØªØ®Ø¯Ù… fallback logic</li>
                </ul>
            </div>
        </div>

        <div class="fix-card">
            <h2>ğŸ”§ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©</h2>
            
            <div class="step">
                <h3>1. ØªØ³Ø¬ÙŠÙ„ SessionMedia ÙÙŠ AppModule</h3>
                <div class="code-block">
// Entities<br>
import { SessionMedia } from './entities/session-media.entity';<br><br>

// Services<br>
import { SessionMediaService } from './services/session-media.service';<br><br>

// Controllers<br>
import { SessionMediaController } from './controllers/session-media.controller';<br><br>

@Module({<br>
  imports: [<br>
    TypeOrmModule.forFeature([<br>
      // ... other entities<br>
      WeeklySessionPlan,<br>
      <span class="highlight">SessionMedia,</span> // â† Ù…Ø¶Ø§Ù<br>
    ]),<br>
  ],<br>
  controllers: [<br>
    // ... other controllers<br>
    WeeklySessionPlanController,<br>
    <span class="highlight">SessionMediaController,</span> // â† Ù…Ø¶Ø§Ù<br>
  ],<br>
  providers: [<br>
    // ... other services<br>
    WeeklySessionPlanService,<br>
    <span class="highlight">SessionMediaService,</span> // â† Ù…Ø¶Ø§Ù<br>
  ],<br>
})
                </div>
            </div>
            
            <div class="step">
                <h3>2. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±ÙØ¹</h3>
                <div class="code-block">
mkdir -p uploads/session-media
                </div>
            </div>
            
            <div class="step">
                <h3>3. Ø¥Ø¶Ø§ÙØ© Static File Serving</h3>
                <div class="code-block">
// ÙÙŠ main.ts<br>
import { NestExpressApplication } from '@nestjs/platform-express';<br>
import { join } from 'path';<br><br>

const app = await NestFactory.create&lt;NestExpressApplication&gt;(AppModule);<br><br>

// Serve static files<br>
app.useStaticAssets(join(__dirname, '..', 'uploads'), {<br>
  prefix: '/api/files/',<br>
});
                </div>
            </div>
            
            <div class="step">
                <h3>4. Ø¥Ø²Ø§Ù„Ø© Fallback Logic Ù…Ù† Frontend</h3>
                <div class="code-block">
// Ù‚Ø¨Ù„ (âŒ Ù…Ø¹ fallback)<br>
if (uploadError.response?.status === 404) {<br>
  console.warn('âš ï¸ File upload endpoint not implemented')<br>
  // Store files locally...<br>
  alert('âš ï¸ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ (Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ù„Ø§Ø­Ù‚Ø§Ù‹)')<br>
}<br><br>

// Ø¨Ø¹Ø¯ (âœ… Ø¨Ø¯ÙˆÙ† fallback)<br>
const uploadedMedia = await sessionMediaService.uploadMultipleFiles(...)<br>
console.log('âœ… Files uploaded successfully to database:', uploadedMedia)<br><br>

// Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹ØŒ Ù„Ø§ Ù†ÙƒÙ…Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©<br>
if (uploadError) {<br>
  alert('âŒ ÙØ´Ù„ ÙÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª: ' + errorMessage)<br>
  return // Ù„Ø§ Ù†ÙƒÙ…Ù„ Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹<br>
}
                </div>
            </div>
        </div>

        <div class="fix-card">
            <h2>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Endpoints</h2>
            
            <div class="endpoint-test">
                <h3>POST /api/session-media/upload-multiple</h3>
                <strong>Ø§Ù„ØºØ±Ø¶:</strong> Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù…Ø¹ Ø­ÙØ¸Ù‡Ø§ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª<br>
                <strong>Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª:</strong><br>
                - files: File[] (Ø§Ù„Ù…Ù„ÙØ§Øª)<br>
                - session_plan_id: string<br>
                - uploaded_by: string<br><br>
                <strong>Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:</strong><br>
                {<br>
                  success: true,<br>
                  data: SessionMedia[],<br>
                  message: "3 files uploaded successfully"<br>
                }
            </div>
            
            <div class="endpoint-test">
                <h3>GET /api/files/session-media/filename.jpg</h3>
                <strong>Ø§Ù„ØºØ±Ø¶:</strong> Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©<br>
                <strong>Ø§Ù„Ù…Ø«Ø§Ù„:</strong> http://localhost:3002/api/files/session-media/session_1699123456_abc123.jpg
            </div>
            
            <div class="endpoint-test">
                <h3>GET /api/session-media/session/:sessionPlanId</h3>
                <strong>Ø§Ù„ØºØ±Ø¶:</strong> Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª Ø¬Ù„Ø³Ø© Ù…Ø¹ÙŠÙ†Ø©<br>
                <strong>Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:</strong> SessionMedia[]
            </div>
        </div>

        <div class="fix-card">
            <h2>âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚</h2>
            
            <ul class="checklist">
                <li>SessionMedia Entity Ù…Ø·Ø¨Ù‚</li>
                <li>SessionMediaService Ù…Ø·Ø¨Ù‚</li>
                <li>SessionMediaController Ù…Ø·Ø¨Ù‚</li>
                <li>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…Ø³Ø¬Ù„Ø© ÙÙŠ AppModule</li>
                <li>Ù…Ø¬Ù„Ø¯ uploads/session-media Ù…ÙˆØ¬ÙˆØ¯</li>
                <li>Static file serving Ù…Ø·Ø¨Ù‚</li>
                <li>Frontend ÙŠØ³ØªØ®Ø¯Ù… endpoints Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©</li>
                <li>Ù„Ø§ ØªÙˆØ¬Ø¯ fallback logic</li>
                <li>Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ø·Ø¨Ù‚Ø©</li>
                <li>WeeklySessionPlan ÙŠØ´Ù…Ù„ media relation</li>
            </ul>
        </div>

        <div class="fix-card">
            <h2>ğŸ¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</h2>
            
            <div class="solution-box">
                <h3>ğŸ‰ Ù…Ø§ Ø³ÙŠØ­Ø¯Ø« Ø§Ù„Ø¢Ù†:</h3>
                <ul>
                    <li>âœ… <strong>Ø±ÙØ¹ Ø­Ù‚ÙŠÙ‚ÙŠ:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª ØªÙØ±ÙØ¹ Ù„Ù„Ø®Ø§Ø¯Ù… ÙˆØªÙØ­ÙØ¸ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                    <li>âœ… <strong>Ø±ÙˆØ§Ø¨Ø· Ø¯Ø§Ø¦Ù…Ø©:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª Ù…ØªØ§Ø­Ø© Ø¹Ø¨Ø± URLs Ø­Ù‚ÙŠÙ‚ÙŠØ©</li>
                    <li>âœ… <strong>Ø¹Ø±Ø¶ ÙÙˆØ±ÙŠ:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹</li>
                    <li>âœ… <strong>Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª ØªØ¨Ù‚Ù‰ Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</li>
                    <li>âœ… <strong>Ù„Ø§ Ø±Ø³Ø§Ø¦Ù„ fallback:</strong> Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ "Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù„Ø§Ø­Ù‚Ø§Ù‹"</li>
                </ul>
            </div>
            
            <h3>ğŸ§ª Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h3>
            <ol>
                <li><strong>Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Backend:</strong> npm run start:dev</li>
                <li><strong>Ø£ÙƒÙ…Ù„ Ù…Ù‡Ù…Ø©:</strong> Ù…Ø¹ ÙˆØµÙ ÙˆÙ…Ù„ÙØ§Øª Ù…Ø±ÙÙ‚Ø©</li>
                <li><strong>Ø±Ø§Ù‚Ø¨ Console:</strong> ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ù‰ "Files uploaded successfully to database"</li>
                <li><strong>ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> Ø¬Ø¯ÙˆÙ„ session_media ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</li>
                <li><strong>ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª:</strong> uploads/session-media ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„ÙØ§Øª</li>
                <li><strong>Ø£Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª ÙŠØ¬Ø¨ Ø£Ù† ØªØ¸Ù‡Ø±</li>
            </ol>
        </div>

        <div class="fix-card">
            <h2>ğŸš€ Ø§Ù„ÙÙˆØ§Ø¦Ø¯</h2>
            <ul>
                <li><strong>ØªÙƒØ§Ù…Ù„ ÙƒØ§Ù…Ù„:</strong> Backend Ùˆ Frontend Ù…ØªÙƒØ§Ù…Ù„Ø§Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</li>
                <li><strong>Ø­ÙØ¸ Ø¯Ø§Ø¦Ù…:</strong> Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                <li><strong>Ø£Ø¯Ø§Ø¡ Ù…Ø­Ø³Ù†:</strong> Ù„Ø§ ØªÙˆØ¬Ø¯ fallback logic ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠØ©</li>
                <li><strong>ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙØ¶Ù„:</strong> Ø±ÙØ¹ ÙÙˆØ±ÙŠ ÙˆØ¹Ø±Ø¶ Ù…Ø¨Ø§Ø´Ø±</li>
                <li><strong>Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØµÙŠØ§Ù†Ø©:</strong> ÙƒÙˆØ¯ Ù†Ø¸ÙŠÙ Ø¨Ø¯ÙˆÙ† Ø­Ù„ÙˆÙ„ Ù…Ø¤Ù‚ØªØ©</li>
            </ul>
        </div>
    </div>
</body>
</html>
